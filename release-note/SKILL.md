---
name: release-note
description: ソフトウェアリリースノートを自動生成するスキル。修正前後のフォルダ比較、History.txt解析、RedMineチケット情報を統合してCSV形式のリリースノートを作成する。
allowed-tools: Read, Glob, Grep, Bash, Write
---

# Release Note Generator

ソフトウェアリリースノートを自動生成するスキルです。

## 使用方法

```
/release-note --before "修正前フォルダパス" --after "修正後フォルダパス" --history "History.txtパス" --customer "顧客名" --device "装置名" --ticket "#チケット番号"
```

## 必須パラメータ

| パラメータ | 説明 | 例 |
|-----------|------|-----|
| `--before` | 修正前フォルダの絶対パス | `D:\old_version` |
| `--after` | 修正後フォルダの絶対パス | `D:\new_version` |
| `--history` | History.txtの絶対パス | `D:\project\History.txt` |
| `--customer` | 顧客名 | `UMTC蘇州` |
| `--device` | 装置名 | `G2128` |

## オプションパラメータ

| パラメータ | 説明 | デフォルト |
|-----------|------|----------|
| `--ticket` | RedMineチケット番号 | なし |
| `--version` | ソフトウェアバージョン | History.txtから自動取得 |
| `--output` | 出力ファイルパス | 自動生成 |

## 処理フロー

1. **History.txt解析**: 最新の変更履歴を抽出
2. **フォルダ比較**: 修正前後のファイル差分を検出
3. **概要生成**: 変更内容を4行以内で要約（コード詳細は含まない）
4. **CSV出力**: 指定フォーマットでリリースノートを生成

## 出力形式

リリースノートは以下のセクションを含むCSVファイルとして出力されます：

### ヘッダー情報
- ドキュメントID: `SOFT-[装置名]-RP-XXXX`
- 顧客名、装置名、リリース日、製番

### 詳細セクション（各項目最大4行）
- **【背景】**: 修正が必要となった経緯
- **【目的と適用範囲】**: 修正の目的と影響範囲
- **【内容】**: 修正内容の概要（コード詳細は含まない）
- **【効果】**: 修正による改善効果
- **【Diff結果】**: 変更されたファイルの一覧

### バージョン情報
- 制御ソフト、各種DLL、PLC等のバージョン

## 記載ルール

1. **各項目は最大4行**で簡潔に記述
2. **コードの直接記載は禁止** - 機能説明のみ
3. **技術用語は必要最小限**に抑える
4. **変更の「何を」「なぜ」**を重視し、「どのように」は省略

## 使用例

### 基本的な使用
```
/release-note --before "D:\Release\v3.19.3.5" --after "D:\Release\v3.19.3.6" --history "D:\Release\v3.19.3.6\History.txt" --customer "UMTC蘇州" --device "G2128" --ticket "#69777"
```

### 出力結果
```
リリースノート_UMTC蘇州_レーザーマーカーで非常停止発生(SOFT-G2128-RP-0280).csv
```

## History.txt形式

以下の形式のHistory.txtに対応：

```
【バージョン】3.19.3.6
【日付】2025/12/19
【チケット】#69777
【概要】レーザーマーカーで非常停止発生
【内容】
・非常停止発生時の処理を修正
・エラーハンドリングを追加
```

または

```
=== v3.19.3.6 (2025/12/19) ===
#69777 レーザーマーカーで非常停止発生
- 非常停止発生時の処理を修正
- エラーハンドリングを追加
```

## 注意事項

- フォルダパスは絶対パスで指定してください
- History.txtはUTF-8またはShift-JISエンコーディングに対応
- RedMineチケット情報は環境変数`REDMINE_API_KEY`が設定されている場合のみ取得

## 関連ファイル

- [テンプレート](templates/release-note-template.csv): CSVテンプレート
